{% extends "admin/base_site.html" %}
{% load i18n admin_urls static admin_list %} 
{% load management_tags %}


{% block content %}
<div id="content-main">
    <h1>{{ title }}</h1>

    <p>{% blocktrans %}Lütfen karı dağıtılacak ayı ve yılı seçin. Sistem, seçilen ayın toplam tahsilatından toplam masrafını çıkararak net karı hesaplayacak ve ortaklara hisselerine göre dağıtacaktır.{% endblocktrans %}</p>

    <form action="" method="post">{% csrf_token %}
        <div>
            {% for obj in queryset %}
            <input type="hidden" name="{{ action_checkbox_name }}" value="{{ obj.pk }}" />
            {% endfor %}

            <div style="display: flex; gap: 20px; margin-bottom: 20px;">
                <label for="id_month">
                    <p><strong>Ay:</strong></p>
                    <select id="id_month" name="month" required style="padding: 5px;">
                        {% for m in months %}
                            <option value="{{ m }}" {% if m == current_month %}selected{% endif %}>
                                {% if m == 1 %}Ocak{% elif m == 2 %}Şubat{% elif m == 3 %}Mart{% elif m == 4 %}Nisan{% elif m == 5 %}Mayıs{% elif m == 6 %}Haziran{% elif m == 7 %}Temmuz{% elif m == 8 %}Ağustos{% elif m == 9 %}Eylül{% elif m == 10 %}Ekim{% elif m == 11 %}Kasım{% elif m == 12 %}Aralık{% endif %}
                            </option>
                        {% endfor %}
                    </select>
                </label>

                <label for="id_year">
                    <p><strong>Yıl:</strong></p>
                    <select id="id_year" name="year" required style="padding: 5px;">
                        {% for y in years %}
                            <option value="{{ y }}" {% if y == current_year %}selected{% endif %}>{{ y }}</option>
                        {% endfor %}
                    </select>
                </label>
            </div>

            <p style="margin-top: 20px; padding: 10px; border: 1px solid #ccc; background-color: #f9f9f9;">
                **UYARI:** Bu işlem, seçilen ay için hesaplanan pozitif net karı, tüm ortakların tanımlı Kar Payı Yüzdelerine göre bölerek **Profit Distribution** kaydı oluşturacaktır.
            </p>

            <p style="margin-top: 20px;">
                <input type="hidden" name="action" value="distribute_profit_action" />
                <input type="submit" name="apply" value="Net Karı Hesapla ve Dağıt" class="default" />
                <a href="{% url 'admin:management_profitdistribution_changelist' %}" class="button cancel-link">{% trans "İptal" %}</a>
            </p>
        </div>
    </form>
</div>
{% endblock %}